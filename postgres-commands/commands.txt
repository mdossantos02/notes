---

### ‚úÖ Query: Find Views That Use a Specific Column (e.g., `users.age`)

```sql
SELECT
    v.schemaname,
    v.viewname,
    v.definition
FROM
    pg_catalog.pg_views v
WHERE
    v.definition ILIKE '%users%' AND v.definition ILIKE '%age%';
```

* This checks for views that mention both the table (`users`) and the column (`age`).
* `ILIKE` is case-insensitive; `%` is a wildcard.

---

### üîç More Robust (Parsing the View Definition)

To get more control or precision, you can look deeper into the parsed dependencies:

```sql
SELECT
    n.nspname AS schema,
    c.relname AS view_name,
    a.attname AS referenced_column
FROM
    pg_attribute a
JOIN
    pg_class c ON a.attrelid = c.oid
JOIN
    pg_namespace n ON c.relnamespace = n.oid
WHERE
    c.relkind = 'v'  -- Only views
    AND pg_get_viewdef(c.oid) ILIKE '%users%'
    AND pg_get_viewdef(c.oid) ILIKE '%age%';
```

> This tells you which **views reference `users.age`** by checking their definition text.

---

### üõ†Ô∏è Optional: Search All View Definitions

If you're not sure exactly what you‚Äôre looking for, you can do a more general search:

```sql
SELECT
    schemaname,
    viewname,
    definition
FROM
    pg_views
WHERE
    definition ILIKE '%users.age%';
```

---

Let me know if you'd like a script to automatically drop and recreate all views that use a specific column.
